{"version":3,"sources":["../src/passport.js"],"names":["JWTStrategy","require","Strategy","ExtractJWT","ExtractJwt","mongoose","User","model","opts","jwtFromRequest","fromAuthHeaderAsBearerToken","secretOrKey","module","exports","passport","use","jwt_payload","done","findById","id","then","user","catch","console","error","err"],"mappings":";;AAAA,IAAMA,cAAcC,QAAQ,cAAR,EAAwBC,QAA5C;AACA,IAAMC,aAAaF,QAAQ,cAAR,EAAwBG,UAA3C;AACA,IAAMC,WAAWJ,QAAQ,UAAR,CAAjB;AACA,IAAMK,OAAOD,SAASE,KAAT,CAAe,OAAf,CAAb;AACA,IAAMC,OAAO,EAAb;;AAEAA,KAAKC,cAAL,GAAsBN,WAAWO,2BAAX,EAAtB;AACAF,KAAKG,WAAL,GAAmB,QAAnB;;AAEAC,OAAOC,OAAP,GAAiB,oBAAY;AAC5BC,UAASC,GAAT,CAAa,IAAIf,WAAJ,CAAgBQ,IAAhB,EAAsB,UAACQ,WAAD,EAAcC,IAAd,EAAuB;AACzDX,OAAKY,QAAL,CAAcF,YAAYG,EAA1B,EACEC,IADF,CACO,gBAAQ;AACb,OAAGC,IAAH,EAAS;AACR,WAAOJ,KAAK,IAAL,EAAWI,IAAX,CAAP;AACA;AACD,UAAOJ,KAAK,IAAL,EAAW,KAAX,CAAP;AACA,GANF,EAOEK,KAPF,CAOQ;AAAA,UAAOC,QAAQC,KAAR,CAAcC,GAAd,CAAP;AAAA,GAPR;AAQA,EATY,CAAb;AAUA,CAXD","file":"passport.js","sourcesContent":["const JWTStrategy = require('passport-jwt').Strategy;\nconst ExtractJWT = require('passport-jwt').ExtractJwt;\nconst mongoose = require('mongoose');\nconst User = mongoose.model('users');\nconst opts = {};\n\nopts.jwtFromRequest = ExtractJWT.fromAuthHeaderAsBearerToken();\nopts.secretOrKey = 'secret';\n\nmodule.exports = passport => {\n\tpassport.use(new JWTStrategy(opts, (jwt_payload, done) => {\n\t\tUser.findById(jwt_payload.id)\n\t\t\t.then(user => {\n\t\t\t\tif(user) {\n\t\t\t\t\treturn done(null, user);\n\t\t\t\t}\n\t\t\t\treturn done(null, false);\n\t\t\t})\n\t\t\t.catch(err => console.error(err));\n\t}));\n};\n"]}